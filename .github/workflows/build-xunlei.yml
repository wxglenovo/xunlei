    - name: Detect Latest Available ImmortalWrt SDK (x86_64)
      id: find_sdk
      run: |
        BASE_URL="https://downloads.immortalwrt.org/releases"

        echo "Fetching release list..."
        # 获取所有版本号
        RELEASE_LIST=$(curl -s $BASE_URL/ | grep -oP 'href="\K[0-9.]+(?=/")' | sort -V)

        echo "All releases:"
        echo "$RELEASE_LIST"

        SDK_FOUND=""
        for REL in $(echo "$RELEASE_LIST" | tac); do
            TARGET_URL="$BASE_URL/$REL/targets/x86/64/"
            echo "Checking SDK under $TARGET_URL"

            SDK=$(curl -s $TARGET_URL 2>/dev/null | grep -oP 'immortalwrt-sdk-[^"]+\.tar\.xz' | head -1)

            if [ -n "$SDK" ]; then
                echo "Found valid SDK in release: $REL"
                SDK_FOUND="$SDK"
                FINAL_RELEASE="$REL"
                FINAL_URL="$TARGET_URL$SDK"
                break
            fi
        done

        if [ -z "$SDK_FOUND" ]; then
            echo "❌ ERROR: No SDK found in any releases!"
            exit 1
        fi

        echo "sdk_file=$SDK_FOUND"         >> $GITHUB_OUTPUT
        echo "sdk_url=$FINAL_URL"          >> $GITHUB_OUTPUT
        echo "release=$FINAL_RELEASE"      >> $GITHUB_OUTPUT

        echo "Selected SDK: $SDK_FOUND (Release: $FINAL_RELEASE)"
